import isObject from '../../utilities/guards/object.ts'
import isString from '../../utilities/guards/string.ts'
import isStringArray2 from '../../utilities/guards/string.arr2.ts'

export interface ExploitRecordData {
  id: string
  exploits: string[][]
}

export const isExploitRecordData = (
  candidate: unknown
): candidate is ExploitRecordData => {
  if (!isObject(candidate)) return false
  const obj = candidate as Record<string, unknown>
  const tests = [isString(obj.id), isStringArray2(obj.exploits)]
  return tests.every(test => test === true)
}

export const isExploitRecordDataArray = (
  candidate: unknown
): candidate is ExploitRecordData[] => {
  if (!Array.isArray(candidate)) return false
  return candidate.every(obj => isExploitRecordData(obj))
}

export const isExploitRecordDataDictionary = (
  candidate: unknown
): candidate is Record<string, ExploitRecordData> => {
  if (!isObject(candidate)) return false
  const obj = candidate as Record<string, unknown>
  return Object.entries(obj).every(([key, value]) => isString(key) && isExploitRecordData(value))
}
